services:
  nginx-proxy-manager:
    image: jc21/nginx-proxy-manager:2.14.0@sha256:2aa69b382a384b676c0d4f1d6f2eac40ecd478fcf7af1cfb3f9f1d3cd0c81e12
    
    # 1. Loads all variables (TZ, Email, Password) from the file
    env_file:
      - /volume2/FastSSD/docker/npm/.env
      
    container_name: Nginx-Proxy-Manager
    healthcheck:
      test: timeout 10s bash -c ':> /dev/tcp/127.0.0.1/81' || exit 1
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 90s
    volumes:
      - /volume2/FastSSD/docker/npm/letsencrypt:/etc/letsencrypt:rw
      - /volume2/FastSSD/docker/npm/data:/data:rw
      - /volume2/FastSSD/docker/npm/config.json:/app/config/production.json
    ports:
      - 443:443
      - 81:81
      - 80:80
      
    # DELETED: environment section
    # (Everything is now safe in the env_file)
      
    restart: on-failure:5
